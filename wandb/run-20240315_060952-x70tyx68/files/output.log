
Starting trainig
Not found pretrained weights. Continue without any pretrained weights.
Training Data Size : 50400
Validation Data Size : 5600
Xsf :  /datasets/FFHQ_parsed_img/44000/44313
not random
Xtf:  /datasets/FFHQ_parsed_img/44000/44313
Xsf :  /datasets/FFHQ_parsed_img/27000/27853
not random
Xtf:  /datasets/FFHQ_parsed_img/27000/27853
Xsf :  /datasets/FFHQ_parsed_img/12000/12943
not random
Xtf:  /datasets/FFHQ_parsed_img/12000/12943
Xsf :  /datasets/FFHQ_parsed_img/49000/49249
not random
Xtf:  /datasets/FFHQ_parsed_img/49000/49249
/opt/conda/lib/python3.7/site-packages/torch/nn/functional.py:3063: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  "See the documentation of nn.Upsample for details.".format(mode))
/opt/conda/lib/python3.7/site-packages/torch/nn/functional.py:2952: UserWarning: nn.functional.upsample is deprecated. Use nn.functional.interpolate instead.
  warnings.warn("nn.functional.upsample is deprecated. Use nn.functional.interpolate instead.")
epoch: 0    0 / 12600
lossD: 3.5104408264160156    lossG: 90.8358154296875 batch_time: 10.885508060455322s
L_adv: 2.8786368370056152 L_id: 1.0403542518615723 L_attr: 3.7508339881896973 L_rec: 0.4391469359397888
L_l2_eyes: 0.008201643824577332
L_landmarks: 0.003641401417553425
loss_adv_accumulated: 19.657572736740114
itertion :
Xsf :  /datasets/FFHQ_parsed_img/32000/32092
not random
Xtf:  /datasets/FFHQ_parsed_img/32000/32092
Xsf :  /datasets/FFHQ_parsed_img/42000/42025
not random
Xtf:  /datasets/FFHQ_parsed_img/42000/42025
Xsf :  /datasets/FFHQ_parsed_img/29000/29044
not random
Xtf:  /datasets/FFHQ_parsed_img/29000/29044
Xsf :  /datasets/FFHQ_parsed_img/48000/48438
not random
Xtf:  /datasets/FFHQ_parsed_img/48000/48438
itertion :
Xsf :  /datasets/FFHQ_parsed_img/34000/34697
not random
Xtf:  /datasets/FFHQ_parsed_img/34000/34697
Xsf :  /datasets/FFHQ_parsed_img/25000/25425
it;s random
Xtf:  /datasets/FFHQ_parsed_img/50000/50344
Xsf :  /datasets/FFHQ_parsed_img/39000/39805
not random
Xtf:  /datasets/FFHQ_parsed_img/39000/39805
Xsf :  /datasets/FFHQ_parsed_img/06000/06812
not random
Xtf:  /datasets/FFHQ_parsed_img/06000/06812
itertion :
Xsf :  /datasets/FFHQ_parsed_img/42000/42314
not random
Xtf:  /datasets/FFHQ_parsed_img/42000/42314
Xsf :  /datasets/FFHQ_parsed_img/07000/07156
not random
Xtf:  /datasets/FFHQ_parsed_img/07000/07156
Xsf :  /datasets/FFHQ_parsed_img/45000/45884
not random
Xtf:  /datasets/FFHQ_parsed_img/45000/45884
Xsf :  /datasets/FFHQ_parsed_img/23000/23337
not random
Xtf:  /datasets/FFHQ_parsed_img/23000/23337
itertion :
Xsf :  /datasets/FFHQ_parsed_img/19000/19591
not random
Xtf:  /datasets/FFHQ_parsed_img/19000/19591
Xsf :  /datasets/FFHQ_parsed_img/08000/08709
not random
Xtf:  /datasets/FFHQ_parsed_img/08000/08709
Xsf :  /datasets/FFHQ_parsed_img/05000/05349
not random
Xtf:  /datasets/FFHQ_parsed_img/05000/05349
Xsf :  /datasets/FFHQ_parsed_img/46000/46177
not random
Xtf:  /datasets/FFHQ_parsed_img/46000/46177
itertion :
Traceback (most recent call last):
  File "train.py", line 651, in <module>
    main(args)
  File "train.py", line 527, in main
    train(args, device=device)
  File "train.py", line 394, in train
    loss_adv_accumulated)
  File "train.py", line 260, in train_one_epoch
    res5 = get_faceswap('examples/images/training/source5.png', 'examples/images/training/target5.png', G, id_extractor, device)
  File "/workspace/utils/training/image_processing.py", line 103, in get_faceswap
    id_embedding, src_emb, tgt_emb = id_extractor(source, target)
  File "/opt/conda/lib/python3.7/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/opt/conda/lib/python3.7/site-packages/torch/autograd/grad_mode.py", line 26, in decorate_context
    return func(*args, **kwargs)
  File "/workspace/extractor/SA_idextractor.py", line 60, in forward
    v_id_source = F.normalize(self.f_id(F.interpolate((i_source - 0.5)/0.5, size=112, mode='bilinear')), dim=-1, p=2).to(self.device)
  File "/opt/conda/lib/python3.7/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/workspace/extractor/arcface_model/iresnet.py", line 147, in forward
    x = self.layer3(x)
  File "/opt/conda/lib/python3.7/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/opt/conda/lib/python3.7/site-packages/torch/nn/modules/container.py", line 117, in forward
    input = module(input)
  File "/opt/conda/lib/python3.7/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/workspace/extractor/arcface_model/iresnet.py", line 49, in forward
    out = self.conv1(out)
  File "/opt/conda/lib/python3.7/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/opt/conda/lib/python3.7/site-packages/torch/nn/modules/conv.py", line 423, in forward
    return self._conv_forward(input, self.weight)
  File "/opt/conda/lib/python3.7/site-packages/torch/nn/modules/conv.py", line 420, in _conv_forward
    self.padding, self.dilation, self.groups)
KeyboardInterrupt